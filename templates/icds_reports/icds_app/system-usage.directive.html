{% load i18n %}
<div>
    <div class="row filters">
        <filters data="$ctrl.data"></filters>
    </div>
    <div class="row no-margin">
        <div class="col-md-11">
            <span class="breadcrump-element" ng-bind="$ctrl.label"></span>
            <span ng-show="$ctrl.step !== void(0)" class="breadcrump-element"> <i class="fa fa-chevron-right" aria-hidden="true"></i> </span>
            <span ng-show="$ctrl.step !== void(0)" class="breadcrump-element" ng-bind="$ctrl.step.label"></span>
        </div>
        <div class="col-md-1 "><i class="fa fa-download fa-2x right pointer"></i></div>
    </div>
    <div class="report-content">
        <div class="row" ng-repeat="section in $ctrl.step.data">
            <div class="col-md-6" ng-repeat="cell in section">
                <div class="report-cell">
                    <div class="row">
                        <div class="col-md-1"
                             uib-popover-html="cell.help_text"
                             popover-placement="right"
                             popover-trigger="'mouseenter'">
                            <i class="fa fa-info-circle fa-2x" ></i>
                        </div>
                        <div class="col-md-11 center">
                            <div class="row">
                                <span class="title" ng-bind="cell.label"></span>
                            </div>
                            <div class="row">
                                <div class="numbers">
                                    <span ng-if="cell.format == 'div'"><span ng-bind="cell.value | number:0"></span>/<span ng-bind="cell.all | number:0"></span></span>
                                    <span ng-if="cell.format == 'number'" ng-bind="cell.value | number:0"></span>
                                    <div ng-if="cell.format == 'percent_and_div'">
                                        <div><span ng-bind="(cell.value / (cell.all || 1) * 100) | number:2"></span> %</div>
                                        <div>(<span ng-bind="cell.value"></span>/<span ng-bind="cell.all"></span>)</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" >
                                <p>
                                    <span ng-show="cell.percent !== null">
                                        <i class="fa" ng-class="{'fa-arrow-down': cell.percent < 0, 'fa-arrow-up': cell.percent > 0}"></i>
                                        <span ng-bind="cell.percent | number:2"></span>
                                        {% trans '% from the day before last' %}
                                    </span>
                                    <i class="fa fa-ellipsis-h fa-2x" aria-hidden="true"></i>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="">
        <div class="dot-menu">
            <div class="dot-menu-item pointer" ng-click="$ctrl.goToStep(step)" ng-repeat="step in $ctrl.steps">
                <div class="dot-menu-dot">
                    <div ng-class="{'dot-active': $ctrl.step.slug === $ctrl.steps[$index].slug}" class="dot"></div>
                </div>
                <div class="dot-menu-label" ng-bind="step.label"></div>
            </div>
        </div>
    </div>
</div>
